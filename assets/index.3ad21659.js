import{I as fe}from"./index.d0618c3d.js";import{M as me}from"./index.7a07a33f.js";import{C as pe}from"./index.5716b4a3.js";import{F as be,u as ye}from"./provide.33f00d49.js";import{d as he,a as f,b as A,w as T,aP as M,n as Ce,av as ge,_ as Ve,p as S,f as t,h as m,M as u,N as o,O as B,q as P,S as U,R as g,F as Fe,ak as ke,i as J,P as we,Q as D,aj as Me,j as K}from"./vue-router.esm-bundler.a03b8b02.js";import{h as Se,e as d,c as Be}from"./components.eb927237.js";import{u as De}from"./index.fc2b15f1.js";import{t as X}from"./elements.39521dbc.js";function $e(e){return["left","right","center"].includes(e)}const Ee={modelValue:{default:void 0},placeholder:{type:String},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},line:{type:Boolean,default:!0},hint:{type:Boolean,default:!0},textColor:{type:String},focusColor:{type:String},blurColor:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:$e},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:{type:Function},onBlur:{type:Function},onClick:{type:Function},onClear:{type:Function},onClose:{type:Function},onChange:{type:Function},"onUpdate:modelValue":{type:Function}},{n:W,classes:Ne}=Be("select"),Ae=he({name:"VarSelect",components:{VarIcon:fe,VarMenu:me,VarChip:pe,VarFormDetails:be},props:Ee,setup(e){const i=f(null),c=f(!1),Y=A(()=>e.multiple),z=A(()=>e.focusColor),V=f(""),F=f([]),p=f("0px"),h=f(0),{bindForm:$,form:l}=ye(),{length:Z,options:b,bindOptions:_}=De(),{errorMessage:x,validateWithTrigger:ee,validate:le,resetValidation:E}=Se(),ae=f(null),se=()=>{const{multiple:s,modelValue:a}=e;if(s){const n=a;F.value=n.map(L)}!s&&!M(a)&&(V.value=L(a)),!s&&M(a)&&(V.value="")},y=s=>{Ce(()=>{const{validateTrigger:a,rules:n,modelValue:r}=e;ee(a,s,n,r)})},k=({value:s,label:a})=>s.value!=null?s.value:a.value,L=s=>{var n;let a=b.find(({value:r})=>r.value===s);return a||(a=b.find(({label:r})=>r.value===s)),(n=a==null?void 0:a.label.value)!=null?n:""},ne=()=>{const{hint:s,modelValue:a}=e;if(!s&&!M(a))return W("--placeholder-hidden");if(s&&(!M(a)||c.value))return W("--placeholder-hint")},j=()=>i.value&&window.getComputedStyle(i.value).width||"0px",oe=()=>{const{disabled:s,readonly:a,onFocus:n}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||(p.value=j(),h.value=X(e.offsetY),c.value=!0,d(n),y("onFocus"))},re=()=>{const{disabled:s,readonly:a,onBlur:n}=e;(l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||(d(n),y("onBlur"))},ie=s=>{const{disabled:a,readonly:n,multiple:r,onChange:C}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||n)return;const v=r?b.filter(({selected:w})=>w.value).map(k):k(s);d(e["onUpdate:modelValue"],v),d(C,v),y("onChange"),!r&&(c.value=!1)},de=()=>{const{disabled:s,readonly:a,multiple:n,clearable:r,onClear:C}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||s||a||!r)return;const v=n?[]:void 0;d(e["onUpdate:modelValue"],v),d(C,v),y("onClear")},te=s=>{const{disabled:a,onClick:n}=e;(l==null?void 0:l.disabled.value)||a||(d(n,s),y("onClick"))},ue=s=>{const{disabled:a,readonly:n,modelValue:r,onClose:C}=e;if((l==null?void 0:l.disabled.value)||(l==null?void 0:l.readonly.value)||a||n)return;const v=r,w=b.find(({label:N})=>N.value===s),G=v.filter(N=>{var H;return N!==((H=w.value.value)!=null?H:w.label.value)});d(e["onUpdate:modelValue"],G),d(C,G),y("onClose")},I=()=>{const{multiple:s,modelValue:a}=e;if(s){const n=a;b.forEach(r=>r.sync(n.includes(k(r))))}else b.forEach(n=>n.sync(a===k(n)));se()},ce=()=>{p.value=j(),h.value=X(e.offsetY),c.value=!0},ve=()=>{c.value=!1},R=()=>le(e.rules,e.modelValue),q=()=>{d(e["onUpdate:modelValue"],e.multiple?[]:void 0),E()};T(()=>e.multiple,()=>{const{multiple:s,modelValue:a}=e;if(s&&!ge(a))throw Error("The modelValue must be an array when multiple is true")}),T(()=>e.modelValue,I,{deep:!0}),T(()=>Z.value,I);const Q={wrapWidth:A(()=>p.value),multiple:Y,focusColor:z,onSelect:ie,reset:q,validate:R,resetValidation:E};return _(Q),d($,Q),{wrapEl:i,offsetY:h,isFocus:c,errorMessage:x,formDisabled:l==null?void 0:l.disabled,formReadonly:l==null?void 0:l.readonly,label:V,labels:F,menuEl:ae,n:W,classes:Ne,computePlaceholderState:ne,handleFocus:oe,handleBlur:re,handleClear:de,handleClick:te,handleClose:ue,reset:q,validate:R,resetValidation:E,focus:ce,blur:ve}}});const Te={key:0},Pe={key:1};function Ue(e,i,c,Y,z,V){const F=S("var-chip"),p=S("var-icon"),h=S("var-menu"),$=S("var-form-details");return t(),m("div",{class:o(e.classes(e.n(),e.n("$--box"),[e.formDisabled||e.disabled,e.n("--disabled")])),onClick:i[3]||(i[3]=(...l)=>e.handleClick&&e.handleClick(...l))},[u("div",{class:o(e.classes(e.n("controller"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:g({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},[u("div",{class:o(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[B(e.$slots,"prepend-icon")],2),u("div",{class:o(e.classes(e.n("wrap"),[!e.hint,e.n("--non-hint")])),ref:"wrapEl",onClick:i[2]||(i[2]=(...l)=>e.handleFocus&&e.handleFocus(...l))},[P(h,{"var-select-cover":"",class:o(e.classes(e.n("menu"))),"offset-y":e.offsetY,disabled:e.formReadonly||e.readonly||e.formDisabled||e.disabled,"default-style":!1,show:e.isFocus,"onUpdate:show":i[1]||(i[1]=l=>e.isFocus=l),onClose:e.handleBlur},{menu:U(()=>[u("div",{ref:"menuEl",class:o(e.classes(e.n("scroller"),e.n("$-elevation--3")))},[B(e.$slots,"default")],2)]),default:U(()=>[u("div",{class:o(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:g({textAlign:e.textAlign,color:e.textColor})},[e.multiple?(t(),m("div",Te,[e.chip?(t(),m("div",{key:0,class:o(e.n("chips"))},[(t(!0),m(Fe,null,ke(e.labels,l=>(t(),J(F,{class:o(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:l,onClick:i[0]||(i[0]=Me(()=>{},["stop"])),onClose:()=>e.handleClose(l)},{default:U(()=>[we(D(l),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(t(),m("div",{key:1,class:o(e.n("values"))},D(e.labels.join(e.separator)),3))])):(t(),m("span",Pe,D(e.label),1)),B(e.$slots,"arrow-icon",{focus:e.isFocus},()=>[P(p,{class:o(e.classes(e.n("arrow"),[e.isFocus,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])])],6),u("label",{class:o(e.classes(e.n("placeholder"),e.n("$--ellipsis"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")],e.computePlaceholderState(),[!e.hint,e.n("--placeholder-non-hint")])),style:g({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},D(e.placeholder),7)]),_:3},8,["class","offset-y","disabled","show","onClose"])],2),u("div",{class:o(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[B(e.$slots,"append-icon",{},()=>[e.clearable?(t(),J(p,{key:0,class:o(e.n("clear-icon")),name:"close-circle",size:"14px",onClick:e.handleClear},null,8,["class","onClick"])):K("",!0)])],2)],6),e.line?(t(),m("div",{key:0,class:o(e.classes(e.n("line"),[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:g({background:e.errorMessage?void 0:e.blurColor})},[u("div",{class:o(e.classes(e.n("dot"),[e.isFocus,e.n("--spread")],[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:g({background:e.errorMessage?void 0:e.focusColor})},null,6)],6)):K("",!0),P($,{"error-message":e.errorMessage},null,8,["error-message"])],2)}const O=Ve(Ae,[["render",Ue]]);O.install=function(e){e.component(O.name,O)};export{O as S};
