import{I as be}from"./index-33db06d9.js";import{M as pe}from"./index-68e2a321.js";import{C as ye}from"./index-8e47720f.js";import{F as he,u as Ce}from"./provide-54996f70.js";import{d as ge,a as m,b as E,aF as k,w as U,at as Ve,n as ke,_ as we,p as N,f as t,h as b,M as c,N as n,O as w,q as W,S as L,R as F,F as X,ai as Fe,i as Z,P as Me,Q as A,ah as Se,j as O}from"./vue-router.esm-bundler-0d52b99f.js";import{d as p,i as Be,b as u,c as $e}from"./components-02edd959.js";import{u as De}from"./index-ccbf3253.js";import{t as _}from"./elements-b6d7a45c.js";function Ee(e){return["left","right","center"].includes(e)}const Ne={modelValue:{default:void 0},placeholder:{type:String},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},line:{type:Boolean,default:!0},hint:{type:Boolean,default:!0},textColor:{type:String},focusColor:{type:String},blurColor:{type:String},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:Ee},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:p(),onBlur:p(),onClick:p(),onClear:p(),onClose:p(),onChange:p(),"onUpdate:modelValue":p()},{n:Y,classes:Ae}=$e("select"),Te=ge({name:"VarSelect",components:{VarIcon:be,VarMenu:pe,VarChip:ye,VarFormDetails:he},props:Ne,setup(e){const r=m(null),v=m(!1),I=E(()=>e.multiple),R=E(()=>e.focusColor),M=m(""),S=m([]),B=E(()=>k(e.modelValue)),C=m("0px"),g=m(0),{bindForm:i,form:l}=Ce(),{length:x,options:y,bindOptions:ee}=De(),{errorMessage:le,validateWithTrigger:ae,validate:se,resetValidation:T}=Be(),oe=m(null),ne=()=>{const{multiple:s,modelValue:a}=e;if(s){const o=a;S.value=o.map(j)}!s&&!k(a)&&(M.value=j(a)),!s&&k(a)&&(M.value="")},h=s=>{ke(()=>{const{validateTrigger:a,rules:o,modelValue:d}=e;ae(a,s,o,d)})},$=({value:s,label:a})=>s.value!=null?s.value:a.value,j=s=>{let a=y.find(({value:o})=>o.value===s);return a||(a=y.find(({label:o})=>o.value===s)),(a==null?void 0:a.label.value)??""},re=()=>{const{hint:s,modelValue:a}=e;if(!s&&!k(a))return Y("--placeholder-hidden");if(s&&(!k(a)||v.value))return Y("--placeholder-hint")},q=()=>r.value&&window.getComputedStyle(r.value).width||"0px",ie=()=>{const{disabled:s,readonly:a,onFocus:o}=e;l!=null&&l.disabled.value||l!=null&&l.readonly.value||s||a||(C.value=q(),g.value=_(e.offsetY),v.value=!0,u(o),h("onFocus"))},de=()=>{const{disabled:s,readonly:a,onBlur:o}=e;l!=null&&l.disabled.value||l!=null&&l.readonly.value||s||a||(u(o),h("onBlur"))},ue=s=>{const{disabled:a,readonly:o,multiple:d,onChange:V}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||a||o)return;const f=d?y.filter(({selected:D})=>D.value).map($):$(s);u(e["onUpdate:modelValue"],f),u(V,f),h("onChange"),!d&&(v.value=!1)},te=()=>{const{disabled:s,readonly:a,multiple:o,clearable:d,onClear:V}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||s||a||!d)return;const f=o?[]:void 0;u(e["onUpdate:modelValue"],f),u(V,f),h("onClear")},ce=s=>{const{disabled:a,onClick:o}=e;l!=null&&l.disabled.value||a||(u(o,s),h("onClick"))},ve=s=>{const{disabled:a,readonly:o,modelValue:d,onClose:V}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||a||o)return;const f=d,D=y.find(({label:P})=>P.value===s),K=f.filter(P=>P!==(D.value.value??D.label.value));u(e["onUpdate:modelValue"],K),u(V,K),h("onClose")},Q=()=>{const{multiple:s,modelValue:a}=e;if(s){const o=a;y.forEach(d=>d.sync(o.includes($(d))))}else y.forEach(o=>o.sync(a===$(o)));ne()},fe=()=>{C.value=q(),g.value=_(e.offsetY),v.value=!0},me=()=>{v.value=!1},G=()=>se(e.rules,e.modelValue),H=()=>{u(e["onUpdate:modelValue"],e.multiple?[]:void 0),T()};U(()=>e.multiple,()=>{const{multiple:s,modelValue:a}=e;if(s&&!Ve(a))throw Error("The modelValue must be an array when multiple is true")}),U(()=>e.modelValue,Q,{deep:!0}),U(()=>x.value,Q);const J={wrapWidth:E(()=>C.value),multiple:I,focusColor:R,onSelect:ue,reset:H,validate:G,resetValidation:T};return ee(J),u(i,J),{wrapEl:r,offsetY:g,isFocus:v,errorMessage:le,formDisabled:l==null?void 0:l.disabled,formReadonly:l==null?void 0:l.readonly,label:M,labels:S,isEmptyModelValue:B,menuEl:oe,n:Y,classes:Ae,computePlaceholderState:re,handleFocus:ie,handleBlur:de,handleClear:te,handleClick:ce,handleClose:ve,reset:H,validate:G,resetValidation:T,focus:fe,blur:me}}});const Pe={key:1};function Ue(e,r,v,I,R,M){const S=N("var-chip"),B=N("var-icon"),C=N("var-menu"),g=N("var-form-details");return t(),b("div",{class:n(e.classes(e.n(),e.n("$--box"),[e.formDisabled||e.disabled,e.n("--disabled")])),onClick:r[3]||(r[3]=(...i)=>e.handleClick&&e.handleClick(...i))},[c("div",{class:n(e.classes(e.n("controller"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:F({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},[c("div",{class:n(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[w(e.$slots,"prepend-icon")],2),c("div",{class:n(e.classes(e.n("wrap"),[!e.hint,e.n("--non-hint")])),ref:"wrapEl",onClick:r[2]||(r[2]=(...i)=>e.handleFocus&&e.handleFocus(...i))},[W(C,{"var-select-cover":"",class:n(e.classes(e.n("menu"))),"offset-y":e.offsetY,disabled:e.formReadonly||e.readonly||e.formDisabled||e.disabled,"default-style":!1,show:e.isFocus,"onUpdate:show":r[1]||(r[1]=i=>e.isFocus=i),onClose:e.handleBlur},{menu:L(()=>[c("div",{ref:"menuEl",class:n(e.classes(e.n("scroller"),e.n("$-elevation--3")))},[w(e.$slots,"default")],2)]),default:L(()=>[c("div",{class:n(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:F({textAlign:e.textAlign,color:e.textColor})},[c("div",{class:n(e.n("label"))},[e.isEmptyModelValue?O("",!0):w(e.$slots,"selected",{key:0},()=>[e.multiple?(t(),b(X,{key:0},[e.chip?(t(),b("div",{key:0,class:n(e.n("chips"))},[(t(!0),b(X,null,Fe(e.labels,i=>(t(),Z(S,{class:n(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:i,onClick:r[0]||(r[0]=Se(()=>{},["stop"])),onClose:()=>e.handleClose(i)},{default:L(()=>[Me(A(i),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(t(),b("div",{key:1,class:n(e.n("values"))},A(e.labels.join(e.separator)),3))],64)):(t(),b("span",Pe,A(e.label),1))])],2),w(e.$slots,"arrow-icon",{focus:e.isFocus},()=>[W(B,{class:n(e.classes(e.n("arrow"),[e.isFocus,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])])],6),c("label",{class:n(e.classes(e.n("placeholder"),e.n("$--ellipsis"),[e.isFocus,e.n("--focus")],[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")],e.computePlaceholderState(),[!e.hint,e.n("--placeholder-non-hint")])),style:F({color:e.errorMessage?void 0:e.isFocus?e.focusColor:e.blurColor})},A(e.placeholder),7)]),_:3},8,["class","offset-y","disabled","show","onClose"])],2),c("div",{class:n(e.classes(e.n("icon"),[!e.hint,e.n("--non-hint")]))},[w(e.$slots,"append-icon",{},()=>[e.clearable?(t(),Z(B,{key:0,class:n(e.n("clear-icon")),name:"close-circle",size:"14px",onClick:e.handleClear},null,8,["class","onClick"])):O("",!0)])],2)],6),e.line?(t(),b("div",{key:0,class:n(e.classes(e.n("line"),[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:F({background:e.errorMessage?void 0:e.blurColor})},[c("div",{class:n(e.classes(e.n("dot"),[e.isFocus,e.n("--spread")],[e.formDisabled||e.disabled,e.n("--line-disabled")],[e.errorMessage,e.n("--line-error")])),style:F({background:e.errorMessage?void 0:e.focusColor})},null,6)],6)):O("",!0),W(g,{"error-message":e.errorMessage},null,8,["error-message"])],2)}const z=we(Te,[["render",Ue]]);z.install=function(e){e.component(z.name,z)};export{z as S};
