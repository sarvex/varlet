import{I as A}from"./index.21798632.js";import{g as F,e as U}from"./elements.e0af8b84.js";import{d as z,a as l,b as h,w as H,o as R,Z as w,_ as B,p as Y,f as g,h as k,M as q,q as Q,N as T,R as Z,O as j,e as G,ay as J,i as b,S as I,al as D,ai as K,P as W,Q as X,F as x}from"./vue-router.esm-bundler.5eeb4635.js";import{c as ee}from"./components.71d12dd0.js";import{C as ae}from"./index.abc42dbc.js";import{d as oe}from"./index.e9517f07.js";import"./shared.f77a40d1.js";const te={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},onRefresh:{type:Function},"onUpdate:modelValue":{type:Function}},{n:ne,classes:se}=ee("pull-refresh"),V=150,le=z({name:"VarPullRefresh",components:{VarIcon:A},props:te,setup(e){let t,d;const s=l(0),c=l(null),v=l(null),i=l(0),a=l(-999),u=l("arrow-down"),n=l("default"),r=l(!1),S=l(!0),p=h(()=>n.value!=="loading"&&n.value!=="success"&&!e.disabled),E=h(()=>({transform:`translate3d(0px, ${a.value}px, 0px) translate(-50%, 0)`,transition:r.value?`transform ${e.animationDuration}ms`:void 0,background:N.value?e.successBgColor:e.bgColor,color:N.value?e.successColor:e.color})),m=h(()=>Math.abs(2*s.value)),N=h(()=>n.value==="success"),P=()=>new Promise(o=>{window.setTimeout(()=>{S.value=!0,o()},V)}),$=o=>{!p.value||(n.value="pulling",i.value=o.touches[0].clientY)},M=o=>{const f=U(t);if(f>0||!p.value)return;f===0&&a.value>s.value&&o.cancelable&&o.preventDefault();const C=(o.touches[0].clientY-i.value)/2+s.value;a.value=C>=m.value?m.value:C,a.value>=m.value*.2?(S.value=!1,u.value="refresh",d=P()):u.value="arrow-down"},_=async()=>{var o,f;!p.value||(r.value=!0,a.value>=m.value*.2?(await d,n.value="loading",a.value=m.value*.3,(o=e["onUpdate:modelValue"])==null||o.call(e,!0),(f=e.onRefresh)==null||f.call(e)):(n.value="loosing",u.value="arrow-down",a.value=s.value,setTimeout(()=>{r.value=!1},w(e.animationDuration))))},L=()=>{const{width:o}=v.value.getBoundingClientRect();a.value=-(o+o*.25),s.value=-(o+o*.25)},O=()=>{setTimeout(()=>{n.value="default",u.value="arrow-down",r.value=!1},w(e.animationDuration))};return H(()=>e.modelValue,o=>{o===!1&&(r.value=!0,n.value="success",u.value="checkbox-marked-circle",setTimeout(()=>{a.value=s.value,O()},w(e.successDuration)))}),R(()=>{t=F(c.value),L()}),{n:ne,classes:se,iconHasChanged:S,ICON_TRANSITION:V,refreshStatus:n,freshNode:c,controlNode:v,touchStart:$,touchMove:M,touchEnd:_,iconName:u,controlStyle:E,isSuccess:N}}});function ue(e,t,d,s,c,v){const i=Y("var-icon");return g(),k("div",{ref:"freshNode",class:T(e.n()),onTouchstart:t[0]||(t[0]=(...a)=>e.touchStart&&e.touchStart(...a)),onTouchmove:t[1]||(t[1]=(...a)=>e.touchMove&&e.touchMove(...a)),onTouchend:t[2]||(t[2]=(...a)=>e.touchEnd&&e.touchEnd(...a)),onTouchcancel:t[3]||(t[3]=(...a)=>e.touchEnd&&e.touchEnd(...a))},[q("div",{ref:"controlNode",class:T(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:Z(e.controlStyle)},[Q(i,{name:e.iconName,transition:e.ICON_TRANSITION,class:T(e.classes(e.n("icon"),[e.refreshStatus==="loading"&&e.iconHasChanged,e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),j(e.$slots,"default")],34)}const y=B(le,[["render",ue]]);y.install=function(e){e.component(y.name,y)};const re={setup(e){const t=Array(10).fill("List Item"),d=Array(10).fill("This is new List Item"),s=l(!1),c=l(t),v=()=>{setTimeout(()=>{c.value=c.value[0]==="List Item"?d:t,s.value=!1},2e3)},i=a=>{a.preventDefault()};return R(()=>{document.body.addEventListener("touchmove",i,{passive:!1})}),G(()=>{document.body.removeEventListener("touchmove",i)}),J(oe),(a,u)=>(g(),b(D(y),{onRefresh:v,modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=n=>s.value=n),"success-duration":"2000"},{default:I(()=>[(g(!0),k(x,null,K(c.value,(n,r)=>(g(),b(D(ae),{key:r,border:""},{default:I(()=>[W(X(n+" "+(r+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},ge=B(re,[["__scopeId","data-v-8f1c7769"]]);export{ge as default};
