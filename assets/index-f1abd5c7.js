import{u as x}from"./provide-5474c667.js";import{d as ee,n as ae}from"./elements-b6d7a45c.js";import{d as te,c as ne,b as y}from"./components-02edd959.js";import{d as le,a as T,b as oe,w as re,o as ue,v as se,Z as L,X as ie,_ as ve,f as k,h as I,M as ce,O as V,N as C,R as W,F as de,ai as fe,j as he}from"./vue-router.esm-bundler-0d52b99f.js";const me={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:te()},pe=250,Te=20,{n:we,classes:ge}=ne("swipe"),Se=le({name:"VarSwipe",props:me,setup(e){const v=T(null),s=T(0),A=oe(()=>e.vertical),c=T(0),u=T(0),i=T(!1),l=T(0),{swipeItems:$,bindSwipeItems:q,length:n}=x();let w=!1,z=-1,g,S,F,h,m;const d=a=>$.find(({index:t})=>t.value===a),j=()=>{e.loop&&(u.value>=0&&d(n.value-1).setTranslate(-c.value),u.value<=-(c.value-s.value)&&d(0).setTranslate(c.value),u.value>-(c.value-s.value)&&u.value<0&&(d(n.value-1).setTranslate(0),d(0).setTranslate(0)))},E=a=>{const t=ie(a)?a:Math.floor((u.value-s.value/2)/-s.value),{loop:o}=e;return t<=-1?o?-1:0:t>=n.value?o?n.value:n.value-1:t},H=a=>{const{loop:t}=e;return a===-1?t?n.value-1:0:a===n.value?t?0:n.value-1:a},N=a=>{const{loop:t}=e;return a<0?t?n.value-1:0:a>n.value-1?t?0:n.value-1:a},D=a=>{const t=u.value>=s.value,o=u.value<=-c.value,r=0,f=-(c.value-s.value);i.value=!0,(t||o)&&(i.value=!0,u.value=o?r:f,d(0).setTranslate(0),d(n.value-1).setTranslate(0)),ae(()=>{i.value=!1,y(a)})},O=()=>{l.value=N(L(e.initialIndex))},B=()=>{const{autoplay:a}=e;!a||n.value<=1||(M(),z=window.setTimeout(()=>{X(),B()},L(a)))},M=()=>{z&&clearTimeout(z)},U=(a,t)=>{if(a>t&&a>10)return"horizontal";if(t>a&&t>10)return"vertical"},Z=a=>{if(n.value<=1||!e.touchable)return;const{clientX:t,clientY:o}=a.touches[0];g=t,S=o,F=performance.now(),w=!0,M(),D(()=>{i.value=!0})},G=a=>{const{touchable:t,vertical:o}=e;if(!w||!t)return;const{clientX:r,clientY:f}=a.touches[0],p=Math.abs(r-g),Y=Math.abs(f-S);if(U(p,Y)===(o?"vertical":"horizontal")){a.preventDefault();const Q=h!==void 0?r-h:0,_=m!==void 0?f-m:0;h=r,m=f,u.value+=o?_:Q,j()}},J=()=>{if(!w)return;const{vertical:a,onChange:t}=e,o=a?m<S:h<g,r=Math.abs(a?S-m:g-h),p=performance.now()-F<=pe&&r>=Te?E(o?l.value+1:l.value-1):E();w=!1,i.value=!1,h=void 0,m=void 0,u.value=p*-s.value;const Y=l.value;l.value=H(p),B(),Y!==l.value&&y(t,l.value)},b=()=>{v.value&&(i.value=!0,s.value=e.vertical?v.value.offsetHeight:v.value.offsetWidth,c.value=s.value*n.value,u.value=l.value*-s.value,$.forEach(a=>{a.setTranslate(0)}),B(),setTimeout(()=>{i.value=!1}))},X=a=>{if(n.value<=1)return;const{loop:t,onChange:o}=e,r=l.value;l.value=N(r+1),(a==null?void 0:a.event)!==!1&&y(o,l.value),D(()=>{if(r===n.value-1&&t){d(0).setTranslate(c.value),u.value=n.value*-s.value;return}r!==n.value-1&&(u.value=l.value*-s.value)})},R=a=>{if(n.value<=1)return;const{loop:t,onChange:o}=e,r=l.value;l.value=N(r-1),(a==null?void 0:a.event)!==!1&&y(o,l.value),D(()=>{if(r===0&&t){d(n.value-1).setTranslate(-c.value),u.value=s.value;return}r!==0&&(u.value=l.value*-s.value)})},K=(a,t)=>{if(n.value<=1||a===l.value)return;a=a<0?0:a,a=a>=n.value?n.value:a;const o=a>l.value?X:R,r=Math.abs(a-l.value);Array.from({length:r}).forEach((f,p)=>{o({event:p===r-1?t==null?void 0:t.event:!1})})};return q({size:s,vertical:A}),re(()=>n.value,async()=>{await ee(),O(),b()}),ue(()=>{window.addEventListener("resize",b)}),se(()=>{window.removeEventListener("resize",b),M()}),{n:we,classes:ge,length:n,index:l,swipeEl:v,trackSize:c,translate:u,lockDuration:i,handleTouchstart:Z,handleTouchmove:G,handleTouchend:J,next:X,prev:R,to:K,resize:b,toNumber:L}}});const be=["onClick"];function ye(e,v,s,A,c,u){return k(),I("div",{class:C(e.n()),ref:"swipeEl"},[ce("div",{class:C(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:W({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.translate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:v[0]||(v[0]=(...i)=>e.handleTouchstart&&e.handleTouchstart(...i)),onTouchmove:v[1]||(v[1]=(...i)=>e.handleTouchmove&&e.handleTouchmove(...i)),onTouchend:v[2]||(v[2]=(...i)=>e.handleTouchend&&e.handleTouchend(...i))},[V(e.$slots,"default")],38),V(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(k(),I("div",{key:0,class:C(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(k(!0),I(de,null,fe(e.length,(i,l)=>(k(),I("div",{class:C(e.classes(e.n("indicator"),[e.index===l,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:W({background:e.indicatorColor}),key:i,onClick:$=>e.to(l)},null,14,be))),128))],2)):he("",!0)])],2)}const P=ve(Se,[["render",ye]]);P.install=function(e){e.component(P.name,P)};export{P as S,me as p};
