import{I as z}from"./index.6d2543c3.js";import{g as F,e as H}from"./elements.6cdeda8d.js";import{d as b,c as Y,f as I}from"./components.3467a955.js";import{d as q,a as l,b as m,w as Q,o as P,Z as N,_ as k,p as Z,f as h,h as E,M as j,q as G,N as w,R as J,O as K,e as W,ay as X,i as D,S as V,ap as R,ai as x,P as ee,Q as oe,F as ae}from"./vue-router.esm-bundler.34317ebb.js";import{C as te}from"./index.203bd217.js";import{d as se}from"./index.e436054e.js";import"./shared.f164cbda.js";const ne={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},onRefresh:b(),"onUpdate:modelValue":b()},{n:le,classes:ue}=Y("pull-refresh"),B=150,re=q({name:"VarPullRefresh",components:{VarIcon:z},props:ne,setup(e){let a,d;const n=l(0),c=l(null),v=l(null),i=l(0),o=l(-999),u=l("arrow-down"),s=l("default"),r=l(!1),g=l(!0),y=m(()=>s.value!=="loading"&&s.value!=="success"&&!e.disabled),$=m(()=>({transform:`translate3d(0px, ${o.value}px, 0px) translate(-50%, 0)`,transition:r.value?`transform ${e.animationDuration}ms`:void 0,background:S.value?e.successBgColor:e.bgColor,color:S.value?e.successColor:e.color})),f=m(()=>Math.abs(2*n.value)),S=m(()=>s.value==="success"),L=()=>new Promise(t=>{window.setTimeout(()=>{g.value=!0,t()},B)}),M=t=>{!y.value||(s.value="pulling",i.value=t.touches[0].clientY)},_=t=>{const T=H(a);if(T>0||!y.value)return;T===0&&o.value>n.value&&t.cancelable&&t.preventDefault();const C=(t.touches[0].clientY-i.value)/2+n.value;o.value=C>=f.value?f.value:C,o.value>=f.value*.2?(g.value=!1,u.value="refresh",d=L()):u.value="arrow-down"},O=async()=>{!y.value||(r.value=!0,o.value>=f.value*.2?(await d,s.value="loading",o.value=f.value*.3,I(e["onUpdate:modelValue"],!0),I(e.onRefresh)):(s.value="loosing",u.value="arrow-down",o.value=n.value,setTimeout(()=>{r.value=!1},N(e.animationDuration))))},A=()=>{const{width:t}=v.value.getBoundingClientRect();o.value=-(t+t*.25),n.value=-(t+t*.25)},U=()=>{setTimeout(()=>{s.value="default",u.value="arrow-down",r.value=!1},N(e.animationDuration))};return Q(()=>e.modelValue,t=>{t===!1&&(r.value=!0,s.value="success",u.value="checkbox-marked-circle",setTimeout(()=>{o.value=n.value,U()},N(e.successDuration)))}),P(()=>{a=F(c.value),A()}),{n:le,classes:ue,iconHasChanged:g,ICON_TRANSITION:B,refreshStatus:s,freshNode:c,controlNode:v,touchStart:M,touchMove:_,touchEnd:O,iconName:u,controlStyle:$,isSuccess:S}}});function ce(e,a,d,n,c,v){const i=Z("var-icon");return h(),E("div",{ref:"freshNode",class:w(e.n()),onTouchstart:a[0]||(a[0]=(...o)=>e.touchStart&&e.touchStart(...o)),onTouchmove:a[1]||(a[1]=(...o)=>e.touchMove&&e.touchMove(...o)),onTouchend:a[2]||(a[2]=(...o)=>e.touchEnd&&e.touchEnd(...o)),onTouchcancel:a[3]||(a[3]=(...o)=>e.touchEnd&&e.touchEnd(...o))},[j("div",{ref:"controlNode",class:w(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:J(e.controlStyle)},[G(i,{name:e.iconName,transition:e.ICON_TRANSITION,class:w(e.classes(e.n("icon"),[e.refreshStatus==="loading"&&e.iconHasChanged,e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),K(e.$slots,"default")],34)}const p=k(re,[["render",ce]]);p.install=function(e){e.component(p.name,p)};const ie={setup(e){const a=Array(10).fill("List Item"),d=Array(10).fill("This is new List Item"),n=l(!1),c=l(a),v=()=>{setTimeout(()=>{c.value=c.value[0]==="List Item"?d:a,n.value=!1},2e3)},i=o=>{o.preventDefault()};return P(()=>{document.body.addEventListener("touchmove",i,{passive:!1})}),W(()=>{document.body.removeEventListener("touchmove",i)}),X(se),(o,u)=>(h(),D(R(p),{onRefresh:v,modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=s=>n.value=s),"success-duration":"2000"},{default:V(()=>[(h(!0),E(ae,null,x(c.value,(s,r)=>(h(),D(R(te),{key:r,border:""},{default:V(()=>[ee(oe(s+" "+(r+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},ye=k(ie,[["__scopeId","data-v-8f1c7769"]]);export{ye as default};
